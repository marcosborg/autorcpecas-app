import{c as ae}from"./chunk-KKLBPVE2.js";import{a as ie,b as ne}from"./chunk-6RIQF3XD.js";import"./chunk-AEZTMUAG.js";import{G as B,K as L,L as N,M as V,R as A,S as H,U as D,V as R,W as U,X as J,Y as q,Z as z,ba as G,c as x,ca as K,da as Q,e as S,ea as X,f as M,g as c,h as _,i as p,j as g,ja as Y,k as s,ka as Z,l,la as $,m as E,ma as ee,n as T,na as te,o as k,p as y,q as w,r as u,s as b,t as I,u as P,v,w as F,x as O,y as W,z as j}from"./chunk-CEFJHDG2.js";import"./chunk-IQNCHDZD.js";import"./chunk-V4Z7YT6R.js";import"./chunk-UHCRRYBY.js";import"./chunk-4PGTP63H.js";import"./chunk-QO6X3PUD.js";import"./chunk-HC6MZPB3.js";import"./chunk-N3PT3BRI.js";import"./chunk-7JAEJH63.js";import"./chunk-FERD25SW.js";import"./chunk-SYQESB6R.js";import"./chunk-LEIMCQKJ.js";import"./chunk-MM5QLNJM.js";import"./chunk-72KDLSWN.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-F2COMJ2U.js";import"./chunk-MCRJI3T3.js";import"./chunk-P5GPMOSE.js";import"./chunk-NGJP4CJH.js";import"./chunk-3TXEPWZY.js";import"./chunk-YTQOYWXA.js";import"./chunk-PUKYQ4VT.js";import"./chunk-G3CV3VGG.js";import"./chunk-UMQDWHM2.js";import"./chunk-PB7KHMCD.js";import"./chunk-5FWCUKLR.js";import"./chunk-4U6PRYVA.js";import"./chunk-QXT6YJJ4.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import"./chunk-RW4GY4BD.js";function le(t,o){if(t&1&&(s(0,"ion-select-option",7),u(1),l()),t&2){let a=o.$implicit;w("value",a.id),c(),b(a.name)}}function de(t,o){if(t&1&&(s(0,"ion-badge"),u(1),l()),t&2){let a=o.$implicit;c(),b(a)}}function me(t,o){if(t&1&&(s(0,"ion-badge"),u(1),l()),t&2){let a=o.$implicit;c(),b(a.name[0].value)}}function ue(t,o){if(t&1&&(s(0,"ion-item")(1,"ion-label"),u(2," Categorias "),s(3,"p"),p(4,me,2,1,"ion-badge",2),l()()()),t&2){let a=y();c(4),g("ngForOf",a.product_categories)}}function ge(t,o){if(t&1&&(s(0,"ion-select-option",7),u(1),l()),t&2){let a=o.$implicit;w("value",a.id),c(),b(a.name)}}function _e(t,o){if(t&1){let a=T();s(0,"ion-item")(1,"ion-select",8),v("ngModelChange",function(n){S(a);let e=y();return P(e.category_id,n)||(e.category_id=n),M(n)}),k("ionChange",function(){S(a);let n=y();return M(n.categorySelect())}),p(2,ge,2,2,"ion-select-option",1),l()()}if(t&2){let a=y();c(),I("ngModel",a.category_id),c(),g("ngForOf",a.categories)}}var Ee=(()=>{let o=class o{constructor(r,n,e,d,i){this.preferences=r,this.api=n,this.router=e,this.loadingController=d,this.alertController=i,this.codes=[],this.category_id=2,this.categories=[],this.manufacturers=[],this.price=0,this.part_name="",this.product_categories=[]}ngOnInit(){this.preferences.checkName("access_token").then(r=>{r.value?(this.access_token=r.value,this.loadingController.create().then(n=>{n.present(),this.preferences.checkName("codes").then(e=>{this.codes=JSON.parse(e.value);let d={access_token:this.access_token};this.api.getManufacturers(d).subscribe(i=>{this.manufacturers=i.manufacturers;let h={access_token:this.access_token,category_id:this.category_id};this.api.getCategories(h).subscribe(f=>{n.dismiss(),this.categories=f.categories})})})})):this.router.navigateByUrl("/")})}categorySelect(){this.loadingController.create().then(r=>{r.present();let n={access_token:this.access_token,category_id:this.category_id};this.api.getCategory(n).subscribe(e=>{this.product_categories.push(e.categories[0]),console.log(this.product_categories);let d={access_token:this.access_token,category_id:this.category_id};this.api.getCategories(d).subscribe(i=>{this.categories=i.categories,r.dismiss(),this.categories==null&&(this.default_category=this.category_id)})})})}createProduct(){!this.manufacturer_id||this.product_categories.length==0?this.alertController.create({header:"Valida\xE7\xE3o",message:"Os campos Fabricante e Categoria s\xE3o obrigat\xF3rios",buttons:["Ok"]}).then(r=>{r.present()}):this.loadingController.create().then(r=>{r.present();let n={access_token:this.access_token,manufacturer_id:this.manufacturer_id};this.api.getManufacturer(n).subscribe(e=>{this.manufacturer=e.manufacturers[0],this.codes.shift();let d=this.codes.join(","),i=[],h=[],f=[];this.product_categories.forEach(m=>{i.push(m.name[0].value),h.push(m.name[1].value),f.push(m.name[2].value)}),i.shift(),h.shift(),f.shift();let oe=i.join(" "),re=h.join(" "),se=f.join(" "),ce={access_token:this.access_token,reference:this.codes[0],categories:this.product_categories,default_category:this.default_category,manufacturer_id:this.manufacturer_id,references:d,price:this.price,name_pt:oe+" - "+this.manufacturer.name,name_es:re+" - "+this.manufacturer.name,name_en:se+" - "+this.manufacturer.name,part_name:this.part_name};this.api.createProduct(ce).subscribe(m=>{if(r.dismiss(),m.id!=""&&m.warnings.length>0)this.alertController.create({header:"Erro",message:m.warnings,buttons:["ok"]}).then(C=>{C.present()});else{let C=m.id;setTimeout(()=>{this.router.navigateByUrl("image/"+C)},500)}},m=>{this.alertController.create({header:"Erro",message:m.message,buttons:["ok"]}).then(C=>{C.present()})})})})}};o.\u0275fac=function(n){return new(n||o)(_(ne),_(ie),_(B),_(te),_(ee))},o.\u0275cmp=x({type:o,selectors:[["app-product"]],standalone:!0,features:[F],decls:26,vars:7,consts:[["label","Fabricante","label-placement","floating",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[4,"ngIf"],["type","number","label","Pre\xE7o","label-placement","floating",3,"ngModelChange","ngModel"],["label","Pe\xE7a","label-placement","floating",3,"ngModelChange","ngModel"],[3,"click"],[3,"value"],["label","Categoria","label-placement","floating",3,"ngModelChange","ionChange","ngModel"]],template:function(n,e){n&1&&(E(0,"app-header"),s(1,"ion-content")(2,"ion-card")(3,"ion-card-header")(4,"ion-card-title"),u(5,"Criar produto"),l(),s(6,"ion-card-subtitle"),u(7,"Preencha com os dados abaixo"),l()(),s(8,"ion-card-content")(9,"ion-list")(10,"ion-item")(11,"ion-select",0),v("ngModelChange",function(i){return P(e.manufacturer_id,i)||(e.manufacturer_id=i),i}),p(12,le,2,2,"ion-select-option",1),l()(),s(13,"ion-item")(14,"ion-label"),u(15," Refer\xEAncias "),s(16,"p"),p(17,de,2,1,"ion-badge",2),l()()(),p(18,ue,5,1,"ion-item",3)(19,_e,3,2,"ion-item",3),s(20,"ion-item")(21,"ion-input",4),v("ngModelChange",function(i){return P(e.price,i)||(e.price=i),i}),l()(),s(22,"ion-item")(23,"ion-textarea",5),v("ngModelChange",function(i){return P(e.part_name,i)||(e.part_name=i),i}),l()()(),s(24,"ion-button",6),k("click",function(){return e.createProduct()}),u(25,"Criar produto"),l()()()()),n&2&&(c(11),I("ngModel",e.manufacturer_id),c(),g("ngForOf",e.manufacturers),c(5),g("ngForOf",e.codes),c(),g("ngIf",e.product_categories.length>0),c(),g("ngIf",e.categories!==void 0),c(2),I("ngModel",e.price),c(2),I("ngModel",e.part_name))},dependencies:[z,j,O,W,V,L,N,ae,D,U,q,J,R,Q,G,K,A,Z,X,H,Y,$]});let t=o;return t})();export{Ee as ProductPage};
