import{a as oe,b as ne}from"./chunk-SP5YGHZS.js";import{a as ee,b as te,c as ie}from"./chunk-KKLBPVE2.js";import{a as Z,b as $}from"./chunk-6RIQF3XD.js";import"./chunk-AEZTMUAG.js";import{G as M,K as V,L as B,M as N,S as U,U as j,V as O,W,X as L,Y as D,Z as z,_ as A,aa as H,ba as q,c as y,da as J,e as h,f as _,g as m,ga as G,h as p,i as x,ia as K,j as C,ja as Q,k as o,l as a,m as I,n as b,na as X,o as u,oa as Y,p as g,r as l,t as w,u as P,v as T,w as S,x as E,y as F,z as R}from"./chunk-CEFJHDG2.js";import"./chunk-IQNCHDZD.js";import"./chunk-V4Z7YT6R.js";import"./chunk-UHCRRYBY.js";import"./chunk-4PGTP63H.js";import"./chunk-QO6X3PUD.js";import"./chunk-HC6MZPB3.js";import"./chunk-N3PT3BRI.js";import"./chunk-7JAEJH63.js";import"./chunk-FERD25SW.js";import"./chunk-SYQESB6R.js";import"./chunk-LEIMCQKJ.js";import"./chunk-MM5QLNJM.js";import"./chunk-72KDLSWN.js";import"./chunk-5OMUW5VI.js";import"./chunk-OBXDPQ3V.js";import"./chunk-F2COMJ2U.js";import"./chunk-MCRJI3T3.js";import"./chunk-P5GPMOSE.js";import"./chunk-NGJP4CJH.js";import"./chunk-3TXEPWZY.js";import"./chunk-YTQOYWXA.js";import"./chunk-PUKYQ4VT.js";import"./chunk-G3CV3VGG.js";import"./chunk-UMQDWHM2.js";import"./chunk-PB7KHMCD.js";import"./chunk-5FWCUKLR.js";import"./chunk-4U6PRYVA.js";import"./chunk-QXT6YJJ4.js";import"./chunk-JWIEPCRG.js";import"./chunk-QPVVTFFW.js";import"./chunk-J6ICYO4L.js";import"./chunk-LF5XB4YN.js";import{f as v}from"./chunk-RW4GY4BD.js";function ce(n,r){if(n&1){let s=b();o(0,"ion-item")(1,"ion-input",8),T("ngModelChange",function(t){let i=h(s).index,c=g();return P(c.codes[i],t)||(c.codes[i]=t),_(t)}),a(),o(2,"ion-button",9),u("click",function(){let t=h(s).index,i=g();return _(i.removeCode(t))}),I(3,"ion-icon",10),a()()}if(n&2){let s=r.index,e=g();m(),w("ngModel",e.codes[s])}}function le(n,r){if(n&1){let s=b();o(0,"ion-toolbar",11)(1,"ion-button",12),u("click",function(){h(s);let t=g();return _(t.createProduct())}),l(2,"Criar produto"),a()()}}function de(n,r){if(n&1){let s=b();o(0,"ion-toolbar",13)(1,"ion-button",14),u("click",function(){h(s);let t=g();return _(t.sendPhoto())}),l(2,"Enviar para an\xE1lise"),a()()}}var Te=(()=>{let r=class r{constructor(e,t,i,c,re){this.preferences=e,this.router=t,this.loadingController=i,this.toastController=c,this.api=re,this.imageUrl="https://ionicframework.com/docs/img/demos/card-media.png",this.photo=!1,this.codes=[],this.takePicture=()=>v(this,null,function*(){this.photo=!1;let ae=yield ne.getPhoto({quality:50,allowEditing:!0,resultType:oe.Base64}),f=new Image;f.src="data:image/jpeg;base64,"+ae.base64String,f.onload=()=>{let d=document.createElement("canvas"),k=d.getContext("2d");if(k){let se=1e3/f.width;d.width=1e3,d.height=f.height*se,k.drawImage(f,0,0,d.width,d.height),this.imageUrl=d.toDataURL("image/jpeg",.5),this.photo=!0}else console.error("Erro ao obter o contexto 2D do canvas")}}),ee({trash:te})}ngOnInit(){this.preferences.checkName("access_token").then(e=>{e.value?this.access_token=e.value:this.router.navigateByUrl("/")})}sendPhoto(){this.loadingController.create().then(e=>{e.present();let t={access_token:this.access_token,imageUrl:this.imageUrl};this.api.sendPhoto(t).subscribe(i=>{this.codes=i,console.log(this.codes),e.dismiss(),this.codes.length==0&&this.toastController.create({message:"N\xE3o encontramos correspond\xEAncia.",duration:3e3,position:"bottom"}).then(c=>{c.present(),this.photo=!1})},()=>{e.dismiss(),this.toastController.create({message:"N\xE3o encontramos correspond\xEAncia.",duration:3e3,position:"bottom"}).then(i=>{i.present(),this.photo=!1})})})}removeCode(e){this.codes.splice(e,1)}trackByIndex(e,t){return e}addCode(){this.codes.push("")}createProduct(){this.preferences.setName("codes",JSON.stringify(this.codes)).then(()=>{setTimeout(()=>{this.router.navigateByUrl("/product")},500)})}};r.\u0275fac=function(t){return new(t||r)(p($),p(M),p(X),p(Y),p(Z))},r.\u0275cmp=y({type:r,selectors:[["app-references"]],standalone:!0,features:[S],decls:20,vars:5,consts:[[3,"src"],["size","small",1,"ion-margin-vertical",3,"click"],[2,"margin-top","20px"],[4,"ngFor","ngForOf","ngForTrackBy"],["color","danger",4,"ngIf"],["color","success",4,"ngIf"],["color","primary"],["expand","full","fill","clear","color","dark",3,"click"],["clearInput","true",3,"ngModelChange","ngModel"],["fill","clear","slot","start",3,"click"],["slot","icon-only","name","trash","aria-hidden","true"],["color","danger"],["expand","full","fill","clear",1,"login-button",3,"click"],["color","success"],["expand","full","fill","clear","color","light",3,"click"]],template:function(t,i){t&1&&(I(0,"app-header"),o(1,"ion-content")(2,"ion-card")(3,"ion-card-header")(4,"ion-card-title"),l(5,"Tirar foto"),a(),o(6,"ion-card-subtitle"),l(7,"Utilize um local bem iluminado e tire de forma aos c\xF3digos serem bem visiveis"),a()(),o(8,"ion-card-content"),I(9,"ion-img",0),o(10,"ion-button",1),u("click",function(){return i.addCode()}),l(11,"Adicionar c\xF3digo"),a(),o(12,"ion-list",2),x(13,ce,4,1,"ion-item",3),a()()()(),o(14,"ion-footer"),x(15,le,3,0,"ion-toolbar",4)(16,de,3,0,"ion-toolbar",5),o(17,"ion-toolbar",6)(18,"ion-button",7),u("click",function(){return i.takePicture()}),l(19,"Tirar foto"),a()()()),t&2&&(m(9),C("src",i.imageUrl),m(4),C("ngForOf",i.codes)("ngForTrackBy",i.trackByIndex),m(2),C("ngIf",i.codes.length>0),m(),C("ngIf",i.photo==!0))},dependencies:[z,ie,j,W,D,L,O,H,U,J,q,K,A,G,R,E,F,N,V,B,Q],styles:[".login-button[_ngcontent-%COMP%]{--color: white}"]});let n=r;return n})();export{Te as ReferencesPage};
